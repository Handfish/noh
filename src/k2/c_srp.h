// Apr 6 2023
// c_srp.h
//
//=============================================================================
#ifndef __C_SRP_H__
#define __C_SRP_H__

//=============================================================================
// Declarations
//=============================================================================
struct SRPVerifier;
struct SRPUser;
//=============================================================================

//=============================================================================
// Defintions
//=============================================================================
//=============================================================================

//=============================================================================
// CSRP
//=============================================================================
class CSRP
{
private:
    struct SRPVerifier*         m_pVerifier;
    struct SRPUser*             m_pUser;
    tstring                     m_sUsername;
    tstring                     m_sPassword;

public:
    ~CSRP();
    CSRP();

    tstring         Start(const tstring &sUsername, const tstring &sPassword);
    tstring         ProcessChallenge(const tstring &sSalt, const tstring &sSalt2, const tstring &sB);
    tstring         GetKey();
    tstring         GetUsername();
    void            Cleanup();
};
//=============================================================================

#endif //__C_SRP_H__
